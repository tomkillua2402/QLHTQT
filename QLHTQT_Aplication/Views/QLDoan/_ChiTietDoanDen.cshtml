
@model QLHTQT_Aplication.Models.QLDoanDenModel
@{
}
<div class="box box-primary popupStyle">
    <div class="box-header with-border">
        <div class="box-header with-border text-center">
            <h3><strong>CHI TIẾT ĐOÀN ĐẾN</strong></h3>
        </div>
        <form action="">
            @Html.HiddenFor(x => x.Id)
            <div class="box-body box-profile">
                <div class="main">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-xs-12 col-sm-2 col-md-2">
                                <label>Tên đoàn vào:</label>
                            </div>
                            <div class="col-xs-12 col-sm-4 col-md-4">
                                @Html.TextBoxFor(x => x.Ten_doan_den, new { @class = "form-control" })
                            </div>
                            <div class="col-xs-12 col-sm-2 col-md-2">
                                <label>Ngày nhập:</label>
                            </div>
                            <div class="col-xs-12 col-sm-4 col-md-4">
                                @Html.TextBoxFor(x => x.Ngay_nhap, new { @class = "form-control" })
                            </div>
                        </div>
                    </div>
                    <fieldset>
                        <legend> </legend>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Họ:</label>
                                    @Html.TextBoxFor(x => x.Ho, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Tên đệm:</label>
                                    @Html.TextBoxFor(x => x.Ten_dem, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Tên:</label>
                                    @Html.TextBoxFor(x => x.Ten, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Ngày sinh:</label>
                                    @Html.TextBoxFor(x => x.Ngay_sinh, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Phân loại đối tác:</label>
                                    @Html.DropDownListFor(x => x.Loai_doi_tac, new SelectList(ViewBag.DSDoiTac, "Id", "Ten_doi_tac"), new { @class = "form-control select2" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Châu lục:</label>
                                    @Html.DropDownListFor(x => x.Chau_luc, new SelectList(ViewBag.DSChauLuc, "code", "name"), new { @class = "form-control select2" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Quốc tịch:</label>
                                    @Html.DropDownListFor(x => x.Quoc_tich, new List<SelectListItem>(), new { @class = "form-control select2" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Nhóm tổ chức:</label>
                                    @Html.DropDownListFor(x => x.Nhom_to_chuc, new SelectList(ViewBag.DSToChuc, "Id", "Ten_nhom"), new { @class = "form-control select2" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Cơ quan công tác:</label>
                                    @Html.TextBoxFor(x => x.Co_quan, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Địa chỉ cơ quan:</label>
                                    @Html.TextBoxFor(x => x.Dia_chi_co_quan, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Chức danh:</label>
                                    @Html.TextBoxFor(x => x.Chuc_danh, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Chuyên ngành:</label>
                                    @Html.TextBoxFor(x => x.Chuyen_nganh, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Số điện thoại:</label>
                                    @Html.TextBoxFor(x => x.SDT, new { @class = "form-control", maxlength = "11" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Email:</label>
                                    @Html.TextBoxFor(x => x.Email, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    <label>Hộ chiếu:</label>
                                    @Html.TextBoxFor(x => x.Email, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    @*<div class="col-xs-12 col-sm-2 col-md-2">
                            <label>Đề tài tư vấn số (Nếu có):</label>
                        </div>
                        <div class="col-xs-12 col-sm-2 col-md-2">
                            <input type="text" class="form-control required" id="Detai_tuvan_so" name="Detai_tuvan_so" value="@Model.Detai_tuvan_so" />
                        </div>*@

                    @*<div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-2 col-md-2">
                                    <label>Đơn vị tiếp nhận:</label>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    @Html.TextBoxFor(x => x.Ten_doan_vao, new { @class = "form-control" })
                                </div>

                                <div class="col-xs-12 col-sm-2 col-md-2">
                                    <label>Liên hệ HUPH:</label>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    @Html.TextBoxFor(x => x.Ten_doan_vao, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="row">
                                <div class="col-xs-12 col-sm-2 col-md-2">
                                    <label>Liên hệ đối tác:</label>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    @Html.TextBoxFor(x => x.Ten_doan_vao, new { @class = "form-control" })
                                </div>
                                <div class="col-xs-12 col-sm-2 col-md-2">
                                    <label>Ghi chú:</label>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4">
                                    @Html.TextBoxFor(x => x.Ten_doan_vao, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>*@

                    <div class="form-group text-center">
                        <button class="btn-sm btn btn-success" onclick="btnSave_Onclick(event)"><i class="fa fa-save"></i>&nbsp;LƯU</button>&nbsp;&nbsp;
                        <button onclick="CloseModal(event)" class="btn-sm btn btn-danger" style="margin-left:5px"><i class="fa fa-close"></i>&nbsp;ĐÓNG</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        debugger
        $('.select2').select2();
        loadCountryByContinents($('#@Html.IdFor(x=>x.Chau_luc)').val());
        $('#@Html.IdFor(x=>x.Quoc_tich)').val('@Model.Quoc_tich').change();
        $('#Ngay_nhap').datepicker({
            autoclose: true,
            todayHighlight: true,
            format: 'dd/mm/yyyy'
        });
        $('#Ngay_sinh').datepicker({
            autoclose: true,
            todayHighlight: true,
            format: 'dd/mm/yyyy'
        });
    });
    $('#@Html.IdFor(x=>x.Chau_luc)').change(function () {
        debugger
        loadCountryByContinents($('#@Html.IdFor(x=>x.Chau_luc)').val());
    });

    $('#SDT').keyup(function () {
        this.value = this.value.replace(/[^0-9\.]/g, '');
    });

    function btnSave_Onclick(e) {
        e.preventDefault();
        var formdata = $("form").serializeArray();
        var data = {};
        $(formdata).each(function (index, obj) {
            data[obj.name] = obj.value;
        });
        $.ajax({
            url: '/QLDoan/_LuuDoanDen',
            type: 'post',
            data: {
                obj: data
            },
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function (data) {
                $("#dynamic-modal-sub").modal('hide');
                ShowToastMessage(data.msg, '', data.type);
                reload();
            },
            error: function (errorThrown) {
            }
        });
    }

    function CloseModal(e) {
        e.preventDefault();
        $("#dynamic-modal-sub").modal("hide");
    }

    function loadCountryByContinents(id) {
        $.ajax({
            url: '/QLDoan/GetCountryByContinents',
            type: 'get',
            async: false,
            data: {
                id: id
            },
            success: function (data) {
                $('#Quoc_tich').find('option').remove();
                $.each(data.data, function (i, x) {
                    var opt = new Option(x.name, x.country_id);
                    $('#@Html.IdFor(x=>x.Quoc_tich)').append(opt);
                });

            },
            error: function (errorThrown) {
            }
        });
    }
</script>
